namespace :schools do
  desc 'Update sample on school with the provided array of INEP codes'
  task update_school_sample: :environment do
    INEP_CODES = [
      35583613,35579853,35276753,35360818,35361033,35283733,35276741,35295668,35276736,35098188,35276704,35276698,35276789,35295673,35276765,35276777,35276728,11000465,11003367,11003391,11045868,11002263,11002182,11000651,11003499,11040440,11003464,11001607,11002204,11002409,11003529,11000201,11040505,11002042,11047690,11002158,11037733,11001070,11037512,11001151,11000635,11041048,11040548,11048328,11003324,11001666,11048301,11001224,11049332,11038039,11037580,11001267,11037598,11001500,11001445,11003669,11003774,11002425,11000562,11003561,11001461,11000546,11043989,11045884,11117834,11001011,11001275,11001003,11000368,11002883,11037881,11049170,11001658,11045892,11118814,11001950,11046660,11043997,11048280,11045825,11003693,11003308,11047780,11002280,11048506,11003383,11049162,11045167,11002999,11047739,11041064,11037865,11002310,11003138,11002956,11048298,11037644,11040920,11047925,11001038,11000660,11001828,11120819,11002778,11117800,11049146,11048310,11002085,11048530,11002093,11048492,11040556,11037636,11047682,11048484,11000473,11001313,11045175,11001186,11045809,11000864,11037652,21200475,21022178,21021139,21281793,21252521,21213631,21275360,21021228,21021333,21016747,21016828,21022429,21303800,21021473,21016550,21021287,21021503,21022615,21021686,21218935,21021619,21194369,21021368,21239851,21016453,21016402,21021627,21016461,21016097,21021414,21261504,21239371,21021481,21016496,21269076,21194543,21020752,21215545,21261539,21017000,21016348,21194653,21261520,21266905,21022151,21021376,21021163,21022283,21016810,21278393,21200807,21022119,21020957,21016909,21194561,21272905,21021074,21022550,21021988,21021880,21194351,21016712,21016968,21272913,21194553,21022445,21201099,21225664,21016585,21022240,21022410,21268967,21021201,21016976,21277346,21022054,21017034,21252483,21016399,21269203,21021511,21016984,21021783,21022542,21021546,21252505,21022046,21021490,21016445, 27050041,27216721,27225259,27028780,27039013,27046265,27040836,27036499,27007120,27002063,27035662,27226336,27037037,27004740,27215024,27046338,27036995,27013944,27226638,27047776,27009904,27038637,27040607,27003213,27007448,27036430,27021645,27218589,27045250,27036758,27036014,27007960,27039005,27029107,27037258,27230562,27003108,27035930,27038319,27038653,27226948,27216136,27037185,27038521,27007987,27036448,27225674,27036685,27037088,27038297,27034917,27016390,27037053,27038629,27035590,27007090,27038580,27036480,27016455,27040240,27035697,27036421,27035573,27002616,27226174,27040860,27014037,27040755,27014002,27006590,27036790,27023516,27012166,27035980,27004376,27036642,27004490,27036650,27035948,27038734,27036677,27013928,27025080,27036561,27024873,27035824,27004368,27014010,27040348,27226271,27009459,27024059,27216616,27024067,27016366,27018962,27016412,27016382,27014932,27016447,27011178,27036707,27035646,27037045,25074695,25073958,25076213,25076205,25076442,25076922,25076167,25075047,25073923,25076434,25074148,25073907,25076892,25128531,25120646,25073699,25075071,25074407,25121685,25074547,25072552,25074091,25074903,25074733,25070720,25074890,25077066,25075020,25073630,25074059,25076256,25073729,25073710,25076493,25074644,25074172,25074326,25073982,25073877,25076183,25074741,25073567,25074288,25073826,25121669,25074377,25073770,25073664,25074806,25074571,25072820,25076930,25070789,35654206,35214942,35248538,35214978,35213093,35243224,35248526,35217448,35217451,35316568,41060962,41060970,41060822,41060989,41060865,41060237,41060806,41059930,41060229,41060148,41060270,41060938,41060016,41060628,41060393,41059980,41060920,41059565,41059786,35075814,35075978,35205527,35478097,35076260,35268367,35477953,35291687,35347280,35281815,35073842,35111727,35077914,35130138,35110361,35077884,35566068,35078724,35085637,35431643,35271697,35050180,35276522,35193847,35386182,35072953,35281578,35211886,35192824,35281566,35200116,35050192,35206143,35050106,35050143,23164964,23165820,23164956,23164972,23165693,23165782,23165111,23164891,23164921,23165456,23322810,23166088,23165677,23193573,23165634,23165413,23272562,23165510,23462280,23165480,23191066,23269561,23164930,23462302,23166010,23262702,23165120,23165804,23166118,23165529,23165502,23194723,23164905,23164999,23234121,23165553,23165626,23165731,23165669,23165570,23164794,23220090,52085864,52079589,52088782,52047776,52094324,52048500,52081907,52047725,52047741,52047687,52070565,52094332,52090841,52047911,52283402,52090850,52048837,52082326,52047733,52085872,22060596,22018026,22051066,22042660,22027548,22049690,22093222,22084320,22018107,22035320,22082077,22029192,22034218,22028650,22135499,22027670,22026304,22027416,22034030,22066179,22028471,22028820,22082204,22034056,22082093,22067701,22137777,22101004,22045716,22027564,22100849,22011145,22058192,22068368,22082280,22028846,22034250,22028188,22059326,22053832,22013601,22081380,22087095,22030123,22029125,22028269,22015884,22083022,22018654,22060600,22027459,22027610,22082298,22080392,22015795,22084266,22027777,22027629,22035702,22085777,22038124,22003100,22038272,22012419,22086625,22034781,22042130,22027556,41062957,41062167,41063171,41145194,41062612,41062574,41063090,41063538,41063546,41145186,41151712,41062710,41145259,41062876,41062930,41062035,41061861,41145178,41062965,41062507,41062361,41063180,41386388,41386426,41062973,41151747,41062493,41063279,41146786,41062680,41145208,41062582,41062639,41145160,41062701,41062604,41375041,41062043,41062620,41061977,41062353,41062485,41062213,41062345,41063414,41062140,41062671,41062370,41061853,41061900,41063260,41062884,41386434,41062183,35301504,35270040,35202307,35435946,35212854,35233328,35205540,35088924,35446282,35467911,35220462,35088936,35275931,35212842,24058491,24013307,24017116,24064238,24019224,24024023,24008060,24027634,24026115,24000663,24020672,24035530,24002267,24045810,24010545,24025550,24020648,24023221,24008389,24048194,24004251,24014508,24046795,24027979,24009377,24058041,24042773,24008087,24044989,24026131,24027286,24050520,24016497,24001899,24019348,24067695,24057436,24021482,24018309,24026549,24046744,24020664,24025887,24052175,24018333,24018368,24043826,24015814,24040436,24055794,24024562,24028444,24018287,24018341,24004278,24049247,24050881,24058351,24041610,24015822,24074381,28009541,28013514,28027930,28018540,28005155,28011074,28007565,28032586,28010060,28003055,28029364,28025032,28001290,28003551,28021177,28025180,28015002,28001630,28026705,28012720,28023153,28018575,28000897,28016360,28018117,28015622,28007140,28018869,28001400,28021568,28003071,28026845,28014081,28026667,28021231,28009894,28022025,28023315,28007867,28019784,28014553,28013867,28006569,28025873,28013840,28018729,28003047,28018931,28002199,28021002,28009401,28018826,28009363,28024540,28005198,28021096,28026969,28007174,28007840,28012062,28011945,28018842,28020235,28021770,28012100,28021746,28019911,28031407,28021100,28018567,28007166,28005848,28026853,28021142,28008243,28018397,28016980,28025733,28018125,28018478,28013093,28020510,28017854,28020502,28007158,28024524,28020766,28017846,28014146,28024559,28006739,28004060,28027795,28013158,28018400,28020480,28018761,28019067,28007190,28032640,28025903,28001680,28018486,28018672,28007816,28005201,28013700,28023730,28022394,28018915,28018320,28009851,28019164,28015983,28021223,28013298,28014138,28020871,28030940,28008235,28016335,28019717,28002865,28018974,28024532,28008057,28013875,28018940,28016890,35060276,35654012,35419953,35267399,35659563,35060215,35246190,35229611,35267417,35273466,35270350,35457197,35659551,35060240,35344552,35229573,35273454,35659514,35229568,35267375,35298360,35229635,35444558,35229600,35229581,35056873,35281177,35060227,35246177,35246207,35277708,35267387,35267429
    ]
    not_found = []
    puts 'Updating schools'
    INEP_CODES.each do |inep|
      school = School.find_by_inep(inep)
      if school
        school.update(sample: true)
        puts "#{inep} - updated"
      else
        not_found.push(inep)
      end
    end
    puts 'Done!'
    puts "Not found schools: #{not_found.to_s}"
  end
end
